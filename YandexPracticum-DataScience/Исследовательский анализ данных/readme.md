# Прогноз температуры стали во время плавки

## Описание проекта

Чтобы оптимизировать производственные расходы, металлургический комбинат ООО «Так закаляем сталь» решил уменьшить потребление электроэнергии на этапе обработки стали. Необходимо построить модель, которая предскажет температуру стали. 

Данные состоят из файлов, полученных из разных источников:

    data_arc_new.csv — данные об электродах;
    data_bulk_new.csv — данные о подаче сыпучих материалов (объём);
    data_bulk_time_new.csv — данные о подаче сыпучих материалов (время);
    data_gas_new.csv — данные о продувке сплава газом;
    data_temp_new.csv — результаты измерения температуры;
    data_wire_new.csv — данные о проволочных материалах (объём);
    data_wire_time_new.csv — данные о проволочных материалах (время).

Во всех файлах столбец key содержит номер партии. В файлах может быть несколько строк с одинаковым значением key: они соответствуют разным итерациям обработки.

## Цели при решении

Критерием для оценки качества моделей будет средняя абсолютная ошибка - МАЕ.

При МАЕ на тестовой выборке:

    - МАЕ <= 6.8 - Работа зачтена;

    - МАЕ <= 6 - Работа выполнена на "отлично".

**МАЕ = 5,4 - Рекорд для данного проекта, если верить тимлиду**

## Решение

В ходе решения задачи было проведено:

- Предобработка данных с изменением типов данных и приведением названий столбцов в таблицах в надлежащий вид;

- объединение таблиц по номеру партии;

- проведен детальный исследовательский анализ с объединенными данными в различных вариациях объединения;

- подготовлены данные обучения модели;

- обучение моделей;

- отчет.

Трудности были связаны с подбором дополнительных признаков, а также в использовании уже существующих. Данная проблема решалось с помощью рассматривания мультиколлинеарности признаков.

Ключевые шаги в решении задачи были - уточнения требований у заказчика и исследовательский анализ данных. В ходе которых были разъяснены основные приоритеты при решении, а также было выбрано два возможных направления для решения задачи.

Одними из основных признаков, используемых для моделей, были дополнительные признаки - первая температура и время нагревания.

### Было рассмотрено два варианта решения:

- с агрегацией данных по номеру партий с последующим добавлением дополнительных признаков; 
- рассматривание задачи по итерациям с использованием не целевых наблюдений в качестве дополнения к обучающей выборке и также с добавлением доп.признаков. 

В обеих решениях лучший результат на кроссвалидации показала модель CatBoost с параметрами:

CatBoostRegressor(depth': 10, 'iterations': 1000, 'l2_leaf_reg': 1, 'loss_function': 'MAE', 'random_state': 30723, 'verbose': 0)

- В первом варианте со значением МАЕ на тесте - 6,05;

  **- Во втором варианте решения со значением МАЕ на тесте - 4,73.**

## Пояснение ко второму(нестандартному) решению.

Что такое сплав?  
Сплав — макроскопически однородный металлический материал, состоящий из смеси двух или большего числа химических элементов с преобладанием металлических компонентов.  

Легирующие элементы могут добавляться по отдельности, а могут совместно(зависит от их совместимости), в каждой итерации замер-нагрев-добавление-замер. С каждым добавлением л.э. мы получаем новый сплав со своими физическими(и химическими) свойствами соответственно с новой оптимальной температурой **именно для данного состава**.  
Последняя температура замера зависит от того, какие химические элементы были добавлены, в какой последовательности и в каком количестве. **При этом, мы можем прервать процесс на любой итерации и получим сталь, который соответствует госту, но не ту, которую хотели**.  
 
 
К примеру, хотим получить сталь 12Х18Н10Т.  
Нам в ковш попадает сталь с содержанием углерода 0,12%,  

    --> делаем замер, делаем нагрев(если температура до этого несоответствовала), добавляем хром, подаем газ для перемешивания, делаем замер(получаем температуру, которая является оптимальной для марки стали 12Х18) 
    --> делаем нагрев, добавляем никель, подаем газ, делаем замер(получаем оптимальную температуру для стали 12Х18Н10) 
    --> делаем нагрев, добавляем титан, подаем газ, делаем замер(получаем оптимальную температуру для стали 12Х18Н10Т) 
 
 
Т.е. внутри процесса одной партии мы(в том числе модель) узнали оптимальную температуру сразу для **трех марок сталей: 12Х18, 12Х18Н10 и 12Х18Н10Т**. 
 
 
Повторю, что я просто увеличил выборку для наблюдений и обучения модели, которая будет предсказывать именно **конечную - целевую** температуру для **каждой партии**. Здесь не нужны никакие дополнительные модели! По сути все тоже самое, что и в обычном решении, просто увеличено количество наблюдений при обучении модели и не более! 